* 第2章 入驻安装

我叫Ubuntu，我的用户喜欢叫我“乌棒兔”。但是我绝对不笨，与某种耳朵长尾巴短的哺乳动物也没有什么联系。我是一个操作系统，我是Linux，我是Ubuntu。

我是一只幸运的Ubuntu，遇到了一个欣赏我，喜欢我，真正能够让我施展才能的用户。今天，我就讲讲我从出生，到被下载进电脑，直至安装到硬盘里的过程。

** 2.1　抵达--获得Ubuntu的途径

在2010年的4月，我来到了这个世界，并由出生的月份得到了我的代号------10.04，也就是2010年4月出生的意思。和我同一天出生的兄弟们还有很多，我们都是Ubuntu
10.04。我们出生前一直在Canonical学校学习------这话您听了可能会费解，怎么出生前就开始学习了呢？
# 回顾ubuntu的历史.
这不怪您，主要是因为咱们不是一个种族的。我们是软件，我们所谓的出生，也叫发布，也就是正式推出的意思。但我们在正式发布之前，其实就已经存在了，只是那时候还不完善，叫做Beta版或者Alpha版。我们出生前有很多的缺点：可能比较懒，经常启动不起来；可能脾气大，有点不顺心就吐一屏幕的英文字母给你看；要不就经不起打击，一不留神就死掉了（别害怕，我们软件死掉容易，复活也简单，重启就行了）。总之，我们出生前有很多的缺点和不足。所以要努力学习，争取到出生的那一天能够成为一个值得信赖的操作系统。或者不叫“出生”吧，听着别扭。这个过程其实有点像你们人类上学，那叫毕业吧？毕业，也就是正式发布的那天。

[[./Images/image00227.jpeg]]*提示：*Ubuntu系统通常在每年4月和10月各发布一个新的系统版本。

*** 2.1.1　毕业了，就要去工作

从Canonical学校毕业之后，我们就该参加工作啦。和你们人类一样，我们毕业的时候，也都充满理想；也都满怀激情；也都各奔东西；也都......不管分配。那我们怎么找工作呢？上招聘网？您见过招聘网站上提供下载操作系统的吗？我们是等着工作来找我们！

比如您想招我到您的电脑上工作，就可以从互联网大道走：到www市，Ubuntu区，com大楼，就找到我们学校了。还有中文分校，离着不远：也在www市，Ubuntu区，org大院里面的cn门。进去之后，您可以在里面随便逛逛，参观一下，了解Ubuntu系统的一些基本知识。之后按照页面上的提示，找到下载我们的网页，就可以开始下载了。一般中文的下载页面是这里：


进到下载页面，会看到一个硕大的橙色按钮写着“开始下载”。不过先别着急点，先在左边选择好你需要的版本，就是图2.1中标示出的这个地方。

[[./Images/image00240.jpeg]]
图2.1　选择要下载的Ubuntu版本

图2.1中上面那个下拉列表框是选择我们Ubuntu系统的版本的。一般会有两个选项，一个是最新的普通版，另一个是最新的长期支持版（就是带LTS的版本）。普通版只提供18个月的支持，18个月以后，虽然系统还能用，但是官方不再提供任何软件升级和补丁了。而长期支持版可以提供3年的支持，并且更加稳定，但是里面的软件就不是最新的了。

[[./Images/image00227.jpeg]]*提示：*无论普通版还是长期支持版，在有新的版本发布之后，都可以在线升级为最新的版本，如从Ubuntu
11.04升级为Ubuntu 11.10。但只能相邻版本升级，不能跨版本升级。如从Ubuntu
10.10不能直接升级为Ubuntu 11.10。

图2.1下面的下拉列表框是选择下载32位系统还是64位系统。虽然现在的电脑基本都是64位的了，不过还是建议一般用户选择32位系统。因为有些软件还没有64位的版本，所以使用32位系统遇到的问题会少一些。

选好之后单击那个硕大的“开始下载”按钮，就开始下载了。这里要说明一下，领我们回家是免费的，不需要花一分钱（当然，您自己的上网费自己掏），我们也不会因为您没花钱就隔三岔五地黑屏重启。

*** 2.1.2　要工作，先要有住处
# 形象类比的提法, 指的是U盘
如果是从互联网大道把我拉回到您的电脑上的，那么您得到的是一个ISO文件，名字大约是ubuntu-10.04.1-desktop-i386.iso、ubuntu-11.10-desktop-i386.iso这样的。不过您如果只是把这个ISO文件静静地放在硬盘里，除了占用一点您宝贵的硬盘空间外是没有任何用处的。要想让我们为您工作，得把我们安装到您的电脑上，让我们在您的硬盘里定居才行。公司招俩研究生不还得给解决户口呢吗，我们也是这个道理。

[[./Images/image00227.jpeg]]*提示：*像Ubuntu
10.04这样长期支持的版本，每过一段时间会推出一个升级版，叫做Ubuntu
10.04.1、Ubuntu 10.04.2之类，就相当于Windows XP系统的SP1、SP2。

要把我安装到您的电脑上有很多方法，最简单的就是把这个ISO文件刻录成光盘来安装。记住，要选择刻录镜像文件（刻录软件不同，叫法可能不一样，不过大概是这个意思）。可不要把ISO包解开，然后把里面一大堆乱七八糟的文件拖进去刻录；也不能直接把ISO文件拖进去，刻完了之后打开光盘一看，里面就一个ISO文件。这么刻完的光盘都是启动不了的。再次重复，要用镜像刻录，这样刻出来的光盘才能够正常地从光驱引导计算机，并进入安装界面。这也是自盘古开天地以来最通用、最正常、最安全的操作系统安装方法------光盘安装。

要想使用光盘安装，您的电脑先得设置成从光盘启动才行。这个大概不用我教您，一般打算安装Linux的人，设置BIOS启动顺序应该不成问题。设置好之后，把光盘放进去，重启就行了。就像现在，我就正静静地躺在一台电脑的光驱里，等待着和我的用户见面，等待着他启动电脑......

** 2.2　启动--安装Linux前的准备

在光驱中躺着，等着电脑启动的时候，心里总觉得有些忐忑，胡思乱想。估计刚毕业的大学生第一次面试之前也是这样吧。不知道我能不能被留在这个电脑里，我可不想被扔在角落里等着落灰。算了，不乱想了，抓紧时间整理一下第一次启动该做的事情吧，省得待会儿出错。

*** 2.2.1　了解计算机的组成

作为一个操作系统，我应该对这个电脑的组成有所了解。好，那就来复习一下。

电脑，大名计算机，要说这可是个伟大的发明。它的出现极大地改变了人们的生活。最初的计算机个头很大，有一大堆这个管那个管，动不动就两个火车头，半拉四合院那么大。里面看上去很复杂，但功能相对简单。随着技术的发展，计算机的体积越来越小，速度越来越快。今天的计算机，看上去比以前简单（实际更复杂），但功能比以前强大了不知道多少倍。不过，虽然经过了复杂的演变，计算机的大体结构还是一样的。就像这年头盖的房子这么多，户型各式各样，但不外乎都有客厅、卧室、厨房、厕所。计算机也一样，不外乎都是由厨房、厕所......哦不对，不外乎都是由处理器、存储器和输入/输出设备组成的。注意，计算机里，没有厨房、厕所！
# 真是一个喜欢动脑的人.我的卧室, linux的内存.
【处理器】

处理器，也就是我们常说的CPU（Center Processing
Unit，中央处理单元）。图2.2所示就是一块CPU，大家都很熟悉。有道是“文臣纸笔安天下，武将刀马定乾坤”。无论干什么，总不能赤手空拳，多少都需要些工具。处理器就是我们软件工作的时候要用到的最重要的工具。每一个软件工作的时候都得用处理器，就好像会计工作得用算盘，厨师工作得用菜刀一样。处理器主要有计算和控制两大功能。

[[./Images/image00241.jpeg]]
图2.2　处理器

计算，好理解吧，就是算数。我们软件做任何工作都需要计算，也就是说我们软件做任何工作都需要用处理器。所以处理器的运算速度，直接影响着我们软件的工作效率。有句话怎么说来着？“工欲善其事，必先利其器”嘛。

那么处理器的控制功能又是什么呢？就是说计算机里的任何一个硬件，都直接或者间接地受处理器的控制。我们软件只要拿着处理器进行操作，就可以实现对声卡、显卡、网卡这些硬件的控制。这有点像汽车，虽然汽车要想行驶起来，需要各个零部件密切的配合，但是司机只要坐在上面，握好方向盘，踩对了油门、刹车、离合器，就可以控制整个汽车的行驶。

【存储器】

再说存储器，存储器就是用来存储程序的地方，换句话说，存储器就是用来给我们软件住宿、工作的空间。再说白点，软件待的地方，就是存储器！比如我现在所在的光盘，就是存储器。不过光盘只是我们软件从一台机器挪到另一台机器的时候所需要的交通工具，真正要定居在一台电脑里的时候，要住在硬盘里。有人说，那硬盘也是存储器了？没错，硬盘、光盘、U盘这些都是存储器。

不过这些存储器有个共同点------都是程序们平时不工作的时候住的地方，它们都属于外存储器。而当一个程序真正要干活的时候是要到另一个空间去的，这个空间就是我们软件的工作间------内存储器，也就是大家常说的内存，比如图2.3所示这个，就是一个内存条。内存的大小对我们的工作效率也有很大的影响，内存越大，工作效率自然越高。你想啊，要是你们公司都坐得人挨人人挤人，恨不得把办公桌摞起来，老张坐老李脑袋上办公，那工作效率能高得了吗？

[[./Images/image00242.jpeg]]

图2.3　内存储器

[[./Images/image00227.jpeg]]*提示：*最初的计算机内部没有磁盘，只有RAM，因此磁盘------包括硬盘、软盘，都算做外存储器。

【输入/输出设备】

那么这个输入/输出设备是干什么用的呢？咱回过头来想想，有了外存了，我们软件的住宿问题解决了。有了内存了，我们有了工作间了。然后又有控制器了，我们有工作的工具了，好，可以开工了！等等，先别急，您想想咱开工干什么啊？得有人给我们任务呀，要不我们拿着CPU算什么呢？不能自己算“1+1=2”玩吧。那么任务是谁给我们的呢？当然是坐在电脑前的人了。

可是，有句话叫人鬼殊途。软件虽然不是鬼，但和人类也是不能直接对话的。所以，我们之间的交流需要设备。输入设备就是用来让人类给我们发指令、分配任务的。比如鼠标、键盘、触摸屏这些都是输入设备。输出设备相反，是用来让我们软件计算得出结果后把结果反映给人类的。显示器、音箱、打印机是输出设备。
# 输入和输出, 可以简单化, 输入键盘和触控板, 输出显示屏, 人脸.
# 眼耳鼻舌身意
我正在整理着思路，忽然感到一阵震动。之后，光盘缓缓旋转，逐渐加速------终于启动了！

*** 2.2.2　先尝后买------用LiveCD体验Ubuntu

这时候电脑正在从光驱引导，光驱里那扇通往内存的IDE通道之门已经打开，我背起我的背包------一个RAM文件系统，走过IDE通道，进入这台机器的内存里。

【第一印象】

进入内存里之后，我把RAM文件系统展开，把里面的东西掏出来放好。背包是我来的时候就打好的，里面是一个能够运行起来的文件系统，包括很多跟我一起干活的同志们，如Firefox、apt、gnome等。把文件系统搞定之后就叫这帮人起来干活。哦，对，还有驱动，赶快翻翻我带来的驱动程序。我们学校的老师教导我们说，第一印象是很重要的，所以一定要在CD上面的RAM系统包里打进尽可能多的驱动程序，这样无论遇到什么硬件，都能够直接地正常使用。否则用户从光盘一启动，就发现分辨率混乱，音箱不出声，那就麻烦了。

马上要显示出界面了。这是我第一次与用户面对面交流，不免有些紧张。听我的学长们说，一般我们Ubuntu系统在第一次运行后会有两种结果：可能我的能力会被认可，我会被安装在这台计算机中，实现自己的价值；或者，在一次不愉快的试用后，连同我乘坐的光盘一起，被扔到一个不知名的角落，或者给用户家的宠物狗当飞盘玩。好吧，不管未来怎样，我现在都要尽自己最大的努力，展现出我最好的一面。

终于，我收拾好了所有的东西，从光盘里来到了内存中。赶紧向还在光盘里的弟兄们汇报一下：“我已出仓，感觉良好......”嘿嘿。哦，对了，用户还在那等着呢，赶快显示出启动界面，如图2.4所示。

[[./Images/image00243.jpeg]]
图2.4　Ubuntu的启动界面
# 我是从此处知道, 操作系统运行在内存里.

【先体验，后安装的LiveCD】

启动界面过去之后，首先要确定一下交流的方式。这很重要，就像你走在大马路上看见一个高鼻梁黄头发蓝眼睛的家伙，不可能过去就拍人家肩膀问：“吃了吗您？”智力正常的人一定是先过去来句：“Excuse me？”（除非你知道这人就是你家隔壁那隆过鼻子，酷爱染发，老戴对美瞳彩片的二嘎子）。但我们软件是无法看到使用者眼睛颜色的，所以我只好像图2.5这样，在屏幕左侧的列表框里列出所有我可以使用的语言，让用户来选择。

[[./Images/image00244.jpeg]]
图2.5　语言选择

这位用户毫不犹豫地在列表框里选中了“中文（简体）”。看来这家伙是个中国人，于是我马上转换到中文跟用户交流。首先我问他想要干什么，我给出如下两个选项。

（1）“试用Ubuntu 10.04.1
LTS”------这个选项的意思就是先尝后买，好不好用得先试试，看着顺眼了再装。新手一般都选这个，能先看见我这系统到底什么样，心里有底了再装。

（2）“安装Ubuntu 10.04.1
LTS”------这不用我说了，意思就是安装，这个选项一般是心里有底的老熟人选的。

可能有人对第1个选项还是不理解。试用？这系统还没装呢就能试用？对，能！因为我们Ubuntu的安装光盘是一张LiveCD。那么什么叫LiveCD呢？

所谓LiveCD，就是直接从光盘就能启动电脑并且运行的系统。整个系统在光盘上，启动后从光盘读取到内存里工作，可以进行一些基本的操作，像上网、听歌、玩游戏什么的，完全不需要硬盘。

通过LiveCD，就可以在安装之前，先对系统有个体验，也可以测试一下计算机的硬件是否都能很好地支持这个系统。如果哪天系统出问题了，还可以用这张光盘启动计算机，对硬盘上的系统进行修复（类似于WinPE的功能）。用户试用之后如果觉得好用，想安装了，就可以双击桌面上的Install图标，把系统安装在硬盘上了（这跟刚才直接选安装是一样的）。

好了，这个使用者像大多数人一样单击了“试用Ubuntu 10.04.1
LTS”按钮，于是我去叫醒和我挤在同一张光盘里的兄弟们：哥儿几个，考验我们的时候到了！

[[./Images/image00227.jpeg]]*提示：*有一些专门专注于LiveCD的Linux发行版，比较有名的有Puppy Linux、Knoppix、Slax等。

【不算高的配置需求】

按照指示，我开始进行系统启动的准备工作。

首先要检查一下这个电脑的硬件配置，如果LiveCD可以启动到桌面，并且速度不是太慢，说明这台电脑的硬件配置基本符合安装的要求。

“什么？你们Linux不就是跟DOS似的系统吗？也对硬件有要求？”对此，我只能说，您好像OUT了。虽然我们Ubuntu系统对硬件配置的要求一般，不算高，可也不能太低了。尤其我们10.04，怎么也得用2000年以后的机器吧。液不液晶无所谓，主要得看机箱里边。像CPU，怎么也得1GHz以上吧，你弄一个800MHz的奔腾3代，也好意思跟我打招呼？！内存512MB起，硬盘怎么也得5GB，什么办公的、作图的、聊天的，能装的软件我全都得给你装上呢。还得有个网卡，无线的有线的都行，ADSL拨号还是接路由的随便，反正得有网。要是没有网络想装Ubuntu，装好了也急死你。


【还算广泛的硬件支持】

除了检查电脑的配置，还要扫描一下这里的所有硬件，以确定加载哪种驱动程序，把能驱动的硬件都驱动起来。因为LiveCD试用的过程也是检查我们Ubuntu系统的硬件兼容性的过程。用光盘启动电脑一看，硬件都正常工作，这就放心了，说明这台电脑装Ubuntu没什么问题，直接装上都不用装驱动。否则可能就要在安装系统之后再上网找驱动安装了。

话说我所在的这台机器条件还不错。4GB的内存很宽敞，硬盘也有500GB大，其他的主要硬件，我也很熟悉。这主要是因为我们在Canonical学校的时候就进行了充分的学习，所以这里的东西我基本上都会用得比较顺手。像大螃蟹公司（特指Realtek公司）的网卡啦、Intel公司的南桥、北桥、声卡及双核CPU，我都能应用自如。只是这里的显卡是Nvidia公司的一款独立显卡，目前我还不能完全驱动它。不过别急，我们这一届Ubuntu系统，专门着重学习了显卡的使用，虽然默认情况下还是不能够启动3D加速，但是2D的显示已经很顺畅了，不会影响使用。要想启用3D加速也不难，等系统装好之后再去安装驱动就可以了。
# 所以这里有意思, Ubuntu跟我一样也在学习的过程中.


检查得差不多了，我从光盘上叫醒了图形部门的哥儿几个，主要是XWindow和Gnome小组，这两个部门负责在屏幕上显示图形操作界面的任务，以后还会经常介绍到他们。兄弟们干活儿都很麻利，只是光驱转得有点慢，所以耽误了一小会儿之后，屏幕上终于显示出了我们Ubuntu的默认桌面，如图2.6所示，应该不算土气了吧。

[[./Images/image00245.jpeg]]
图2.6　LiveCD启动后的系统界面

启动了之后，用户很好奇地点来点去。先是玩了会儿游戏；又看了看光盘里的一些示例文档；再打开Firefox上了会儿网。最后终于下定决心，双击了桌面上那个“安装Ubuntu
10.04 LTS”的图标------装！

** 2.3　入住

终于开始安装了，我要住进这台电脑啦！安装一共有7步。

*** 2.3.1　第1步：选择语言

跟启动一样，还得先问一下用户打算使用什么语言，如图2.7所示。有人说了，你这家伙健忘吧，刚才不是选过了吗？别急，听我解释。刚才选择的是从光盘启动的LiveCD系统使用什么语言，这回选择的是安装到硬盘的系统用什么语言。当然，我也不傻，知道一般情况下这两个都是一样的，所以给用户默认选择了简体中文。然后，用户只要单击“前进”按钮，这一步就算完成了。

[[./Images/image00246.jpeg]]
图2.7　选择安装系统的语言

*** 2.3.2　第2步：选择时区

选择时区也简单，根据主人选择的语言，我估计是个中国人，虽然这个国家地方大，不过全国都是一个时区，因此我替他选择了亚洲区，中国，上海------也就是东8区，如图2.8所示。好了，他继续单击“前进”按钮。

[[./Images/image00247.jpeg]]
图2.8　选择时区

*** 2.3.3　第3步：选择键盘布局

这个我也代劳了，替他选择了美式键盘，多数情况下是没错的。如果不是，可以单击“猜测键盘布局”单选按钮，然后单击后面的“猜测...”按钮，之后按照我的提示按下一些按键，我就可以知道用户用的是什么键盘了。或者，用户也可以自己直接在下面的列表框里选择自己的键盘。如果不知道自己选得对不对，我还给他提供了一个文本框来测试，就是图2.9所示的那个，多体贴啊！好，我的这位用户还是直接单击了“前进”按钮。

[[./Images/image00248.jpeg]]
图2.9　选择键盘布局

*** 2.3.4　第4步：分区

这回要了亲命了......好，咱一点一点慢慢说。到第4步分区这里，首先会有几个选项，让你选择分区的方式。

【清空并使用整个硬盘】

我最喜欢的是“清空并使用整个硬盘”，就像图2.10这样。这个选项的意思就是说不管现在硬盘里住着谁，有什么东西，统统给我卷铺盖走人，爷要住了！（低调低调）这样装完了之后硬盘上就啥都没有了，只剩我一个Ubuntu系统。不过一般人不会选这个选项，因为多数情况下硬盘里已经住了一个系统，而且用户并不想赶他走。

[[./Images/image00249.jpeg]]
图2.10　清空并使用整个硬盘

【分别安装它们，在启动时从中选择】

还可以选这个选项：“分别安装它们，在启动时从中选择”，如图2.11所示。选了这个选项你就什么也不用管了，一切交给我来处理，我办事，你放心。用户可以做的就是调整一下给我这个系统分配的空间，然后我自己会修改你已有的分区大小，挤出足够我住的地方来并安装。

[[./Images/image00250.jpeg]]
图2.11　分别安装它们，在启动时从中选择
*提示：*这种改变分区大小的动作还是有一定危险性的，请谨慎使用。

【使用最大的连续空闲空间】

比较没危险的就是这个“使用最大的连续空闲空间”。意思就是说，已经在硬盘里住下的系统不去管他，空间也不用调整。有多少地方空着呢，我就去那里整理整理住下。不过要注意，这个“空着”，可不是指你的E盘或者D盘之类的有空闲空间就行，而是得有没分区的空间，就像图2.12中的“未指派”的那样的区域才行。所以，要选这个选项，你需要事先在硬盘上空出一部分空间来不分区，或者把已有的分区删掉一个才行。

[[./Images/image00251.jpeg]]
图2.12　Ubuntu需要的硬盘空间

以上几个选项都是自动分区的，也就是由我自己决定划分多大的分区出来，哪个分区作为“/”等。最后一个选项就是“手动指定分区”，这个选项就需要了解分区知识的用户才能用，所以后面写了个“（高级）”。好，现在咱就仔细说说手动分区。

【手动分区】

选择了“手动分区”单选按钮并单击“前进”按钮之后，首先会显示出电脑当前的分区状态，如图2.13所示。同时，还可以注意到，总共的步骤变成了8步。多出了一步手动分区的步骤，也就是你现在正在操作的步骤，后面的步骤依次顺延。好，来看看怎么分。

[[./Images/image00252.jpeg]]

图2.13　手动分区

上方用一根棍状物体表示的就是你的硬盘，里面可能已经有一些不同种类的分区，用不同的颜色表示，下面用文字具体描述了当前分区的状况。有人会问，这个/dev/sda是什么啊，看着怎么这么奇怪呢？好，凑近点看，如图2.14所示。

[[./Images/image00253.jpeg]]
图2.14　硬盘和分区的表示方法

不必奇怪，/dev/sda是我们Linux用来表示硬件的方式。/dev/是一个目录，你看这个名字，dev，就是device的简写，这个目录下面放的全是设备文件（在我们Linux世界里，什么东西都是文件，硬件设备也是文件）。这个/dev/sda，就是/dev目录下的sda文件，这个文件代表什么呢？代表你的硬盘！sd代表存储设备，可能是硬盘，可能是U盘，也可能是SD卡之类的，a代表第1块，那么第2块就是sdb，第3块就是sdc。如果不考虑U盘之类的移动存储设备（假设安装的时候没插着），那么/dev/sda的意思就是你的电脑上的第1块硬盘。要是第2块，那自然就是/dev/sdb了。那么下面那个/dev/sda1呢？就是/dev/目录下的sda1文件，这个文件代表你的第1块硬盘上的第1个分区。那么第1块硬盘上的第2个分区就是/dev/sda2，第2块硬盘上的第4个分区就是/dev/sdb4。

*提示：*旧版内核还会区分IDE硬盘和SATA硬盘，IDE硬盘的设备文件为/dev/hdx，而SATA硬盘的设备文件为/dev/sdx，现在都统一为/dev/sdx。

那么现在，选中列表框里面“空闲”的硬盘空间，然后单击“添加”按钮，来添加一个分区。如果没有空闲呢？那就找一个你看着不顺眼的分区删呗！（上面的数据丢了别赖我啊，记得提前保存好）。添加分区的步骤并不复杂，就下面这么几步。

（1）单击“添加”按钮之后，会出现一个如图2.15所示的“创建分区”对话框，在其中可以选择分区类型是主分区还是逻辑分区。如果你不知道这两个选项有啥区别，那就不要动，用默认的就好，反正我们Ubuntu系统装在什么分区都可以。

[[./Images/image00254.jpeg]]

图2.15　创建root分区

（2）其次是分区容量，这个不用多解释吧，在文本框里写上希望的分区大小就可以了，单位是MB。

（3）分区的位置，一般也不用改，用“起始”就好。

（4）选择文件系统，也就是图2.15中的“用于”那个下拉列表框。我们Linux是不能使用FAT或者NTFS这样的文件系统的，这都是Windows系统用的。我们可以用的文件系统很多，新手可能不知道选哪个好。关于每个文件系统的区别和特点，来日方长，有机会慢慢说，现在，如果你不知道选啥，那就还是选默认的Ext4日志文件系统好了。

[[./Images/image00227.jpeg]]*提示：*安装时可选的其他几种文件系统中，reiserfs对于存取大量小文件的操作效率较高；XFS对大分区、大文件的操作有优势；btrfs对SSD硬盘做了一定的优化。

（5）挂载点，是让你指定这个分区用来干什么的。必须有挂载点是“/”。也就是说，你至少要分出一个区，挂载点选“/”。这个区有5GB就够安装系统的，不过如果你想拿我们Ubuntu作为日常使用的系统，而不是只装来玩玩的话，大方一点，分20GB吧。

好了，全都选完了，单击“确定”按钮，一个分区就建好了。

创建了“/”分区之后，再创建一个交换空间，步骤同上，只是在选“用于”的时候选“交换空间”，就行了，挂载点不用选，如图2.16所示。交换空间就相当于Windows下的虚拟内存，它的大小大约等于内存的大小就可以。如果内存很小（1GB以下），交换空间最好是内存的两倍。

[[./Images/image00255.jpeg]]

图2.16　创建交换空间

[[./Images/image00227.jpeg]]*提示：*对于2GB以上的内存，日常应用基本不需要交换空间，只会在休眠的时候用到。因此即使不分交换空间，系统也是可以工作的。

好了，分了“/”分区和交换空间就可以继续进行了。但是更专业一点，最好再分个“/home”分区。这里以后存的都是你自己的各种文件，音乐、电影、图片、各种文档，以及各种软件的配置文件都在这里，所以要尽量大一点。并且以后如果要重装Ubuntu系统，只要保留这个分区不格式化，并且依旧挂载为“/home”，那么这些个人信息就都还在。把上面说的这些都建好了之后，就可以看到类似图2.17所示的效果。

[[./Images/image00256.jpeg]]
图2.17　手动分区最终效果

我遇到的这个用户似乎有些经验，对分区这种事情比较了解，直接就选择了手动分区，然后分了20
GB给“/”分区，又分了220GB给“/home”，还分了2GB的swap区（就是交换空间啦）。分的时候我注意到，硬盘里另外的几个分区中似乎住着一个Windows
7系统，嗯，看来我有邻居了。

*** 2.3.5　第5步：填写一些基本信息

*提示：*如果上面选了手动分区就是第6步，以下同理。

分区完成，进入第5步，就会看到如图2.18所示的界面。这里有如下几项要填写。

[[./Images/image00257.jpeg]]
图2.18　创建用户界面

（1）名字，就是在文本框里写上你的名字呗，遗憾的是不能用中文。我这个用户填了名字叫lanwoniu。
（2）登录名，就是一般所说的用户名。刚才那个名字是用来显示的，这个名字是用来登录的，以后让你填这个系统的用户名时，填的就是这个。一般这两个名字都一样，于是在用户填写名字的时候，我就替他把登录名也写成lanwoniu了，他也没反对，
（3）然后是密码，按照国际惯例，输两遍。
（4）计算机名，随便起就行，我的用户给他的电脑起了个名字叫snail-computer，看来是嫌他的电脑太快了。
（5）最下面还有3个单选按钮，我逐个解释一下。

[[./Images/image00218.jpeg]]　“自动登录”------这个选项就是说系统启动的时候，自动用你现在创建的这个用户登录，不用输入密码。

[[./Images/image00218.jpeg]]　“登录时需要密码”------这个选项就是普通的登录模式，登录时需要选择用户并且输入密码。

[[./Images/image00218.jpeg]]　“登录时需要密码并且加密我的主目录”------这个选项在使用上跟第2个没有区别，但是这个用户的主目录会被加密存储。

都填好了之后，还是单击“前进”按钮，就进入下一步了。

这里要说明一下。这一步创建出来的这个用户是拥有管理员权限的用户，但是不是root用户哦，所以这里不要试图创建root用户。可能有的同学听说过Linux下面有个root用户很好很强大，不过在我们Ubuntu系统里，你可以渐渐淡忘这个root用户了。这一步创建的这个用户虽然不是root，但是，这个用户却有着变身成root的权力！

[[./Images/image00227.jpeg]]*提示：*root用户的权力过大，使用root登录时如果出现误操作，很容易造成不可补救的后果，因此Ubuntu系统默认禁用了root用户。

*** 2.3.6　第6步：导入用户信息

如果电脑里已经有了其他的操作系统，我可以帮助用户把原来放在那个操作系统上的一些配置信息，数据什么的导入到新的系统上来。包括原来的浏览器里的书签，原来桌面的壁纸、用户存的图片、文档、音乐等，我都可以顺手给存在我这边。图2.19所示是一个导入用户信息的示例。

[[./Images/image00258.jpeg]]
图2.19　导入用户信息

*** 2.3.7　第7步：确认信息

前面的操作都做完了之后，这里会让你确认一下之前步骤中所做出的各种选择，如图2.20所示。尤其是对硬盘分区的修改，要是现在反悔还来得及，因为到目前为止我还没有做任何实质的改动。如果没什么问题，看见没有，右下角那个按钮不是“前进”了，变成“安装”按钮了。别犹豫，来吧！

[[./Images/image00259.jpeg]]
图2.20　安装前的最后确认

安装的过程中我会去网上查找有没有可用的更新，如果有什么软件有新的版本了，就不给你装光盘上的，直接从网上下载最新的装上。还有一些光盘上没有的语言包，也会从网络上下载。不过下载的速度一般会比较慢，因为我只会去国外的官方网站上找（我刚出生嘛......就从那来的，所以只认识那）。要是你等不及的话（一般人都等不及），安装的时候干脆把网线拔了，断了我这念想，装得就快了，有半小时也就装完了。当然，这还得看你的电脑速度。

*** 2.3.8　扩展阅读：Linux中的最高权限

在安装的过程中，咱们介绍了Linux系统中有个root用户，拥有着最高的操作权限。有的同学可能会说：“我知道，root就相当于Windows系统里的administrator嘛，都有着最高的权限。”很好，领悟得很快，但是------并不准确。

【并非至高无上的administrator】

Windows系统下权力最高的是谁？是administrator吗？很遗憾，不是。是SYSTEM！也就是系统自己，Windows7自己。任何管理员的权利都不能大于Windows7自己的权利。你可以试试去把C:\WINDOWS下的regedit.exe删了。能吗？“哇！我删了耶，没报错。”别着急，刷新几下看看，是不是又出来了？Windows7会保护自己，不叫人类破坏。这个初衷看似还是好的，但是当Windows7自己中毒的时候，就不一样了。当他中毒时，就像被外星生命寄生了的人类（异型看过吧？），就不再是正常的人了，不正常的Windows7仍然会努力保护自己，不让人动他身上的任何部分------包括已经中毒变坏的部分。

【真正至高无上的root】

那么Ubuntu下（其他Linux系统也是一样）权力最高的是谁？毫无疑问是root！是这个用来给人类登录的用户。root在系统中拥有真正的至高无上的权力。他真的无所不能，他可以运行 =rm *-rf=（危险动作，切勿尝试，后果自负）删除系统中的所有文件。或许我会语重心长地警告他：这么干很危险滴，这么干就都删光光了，这么干我这个系统就嗝屁了，不存在了！但是，当他确认地告诉我，他现在很清醒很冷静，知道自己在干什么之后，我会义无反顾地流着两行热泪按照他的命令去做！哪怕他要格掉整个硬盘，我也照办。这真是，君叫臣死，臣不得不死；他叫我格，我不能不格（Windows下是不可能在系统运行的时候格掉系统盘的）。

【理念不同带来的权力不同】

会有这样的区别，原因还是我们两个系统的理念不同。

Windows7认为：人类是会犯错误的，很可能一不小心就把系统搞坏了，所以必须加以限制。有些事情让做，有些事情无论如何不能让他们做。而我总觉得，人类是聪明的，他们知道自己在干什么------尤其是用root登录进来的人。我认为他是了解我，了解整个电脑才会用root登录进来做事情的。所以他的命令不会受到任何的阻挠。而一般的用户会用普通账号登录，既然用普通账号登录，就说明他们承认自己只是个使用者，可能会做错事。那么我就会稍微进行限制，让他们不会破坏我，也不会破坏其他用户的东西。所以，当你用root账户登录进来的时候，一定不要辜负我对你的信任。

*** 2.3.9　扩展阅读：Linux的分区和挂载

在安装的过程中，有的同学对这个Linux系统的分区还是不大明白，因为跟Windows下的有些区别。没事，咱们仔细说说。

【你们住房子，我们住硬盘】
# 类比得好。
话说我们软件要想在一台电脑里定居，得有个住的地方，就好像你们人类要在一个城市里定居得有个住处一样。不过我们软件并不像人类一样，住在钢筋水泥的格子里面，我们住的地方，是一块叫做硬盘的空间。说起来我们住的这个硬盘空间，和你们人类住的这个房子是很相似的。那我们就拿您这房子来做对比，说说我们这个硬盘空间吧。

首先，你们人类的房子就是一大块能放东西的空间，是吧。有大有小，100平米的、200平米的、40平米的都有。里面放着洗衣机啊、电冰箱啊、床啊、桌子啊之类的各种东西。我们软件住的硬盘也是一大块能放东西的空间，大小也不一定，什么80GB的、200GB的、500GB的、一个TB的都有。里面存着文档、电影，各种程序，以及我这个操作系统等数据。
#+BEGIN_SRC shell :results output
lsblk
#+END_SRC

#+RESULTS:
: NAME                 MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
: loop0                  7:0    0  89.1M  1 loop /snap/core/7917
: loop1                  7:1    0  89.1M  1 loop /snap/core/8039
: sda                    8:0    0   113G  0 disk
: ├─sda1                 8:1    0   512M  0 part /boot/efi
: └─sda2                 8:2    0 112.5G  0 part
:   ├─vgkubuntu-root   253:0    0 111.6G  0 lvm  /
:   └─vgkubuntu-swap_1 253:1    0   980M  0 lvm  [SWAP]


你们的房子一般不会是一个整个的空间（毕竟那是要住人的，不是仓库），而是会被分割成几个小的空间，一间屋，一间屋的。我们的硬盘虽然也可以好几百GB整个用，可也不是很方便，一般也会被分割成几个小的空间，每个空间就叫一个分区，一个分区就好比你们那一间屋。

#+BEGIN_SRC shell :results output
fdisk -l
#+END_SRC

#+RESULTS:

【住房要有很多功能空间】

好，关于屋子和分区的事情暂时先放放，说说你们人类日常生活习性的问题。你们一般每天要吃3次饭，一般不愿意露天吃，是吧，需要有一个吃饭的地方。而且既然吃饭，就得有个做饭的地方，甭管是谁做，反正得加工一下，不像兔子似的路边上逮着块草地就能过去啃两口。一天3顿饭之后，得休息，需要有睡觉的地方，大桥底下也好，水床上面也罢，总得有个地方。那么刚才说的你那房子里，就有为满足你的各种需求而设计的各种功能空间。有放着床睡觉的地方；有摆着炉灶，锅碗瓢盆啥的地方，那是做饭的地儿；放个饭桌，这一看就知道，吃饭的地儿；放个马桶，那这就是厕所。
#+BEGIN_SRC shell :results output
df -hl
#+END_SRC

#+RESULTS:
#+begin_example
Filesystem                  Size  Used Avail Use% Mounted on
udev                        1.9G     0  1.9G   0% /dev
tmpfs                       385M  1.4M  384M   1% /run
/dev/mapper/vgkubuntu-root  110G   48G   57G  46% /
tmpfs                       1.9G  174M  1.8G  10% /dev/shm
tmpfs                       5.0M  4.0K  5.0M   1% /run/lock
tmpfs                       1.9G     0  1.9G   0% /sys/fs/cgroup
/dev/loop0                   90M   90M     0 100% /snap/core/7917
/dev/loop1                   90M   90M     0 100% /snap/core/8039
/dev/sda1                   511M  7.9M  504M   2% /boot/efi
tmpfs                       385M   16K  385M   1% /run/user/1000
#+end_example

那么我们Linux的硬盘里也有类似的情况（当然，我可不是说我们这也有厨房厕所啊）。我们Linux系统有着独特的目录结构，最基本的是一个根目录，我们喜欢叫它“/”，它就像您那整个一大间屋子。“/”目录下还有很多的目录，比如“/etc”，是用来存配置文件的；“/bin”是用来放二进制程序的；“/boot”是用来放启动文件的；“/lib”是用来放库文件的；还有“/home”是用来放用户的各种文件的。这一个个的目录，就好像你房里一个个的功能空间一样，各有各的用途。
# bin boot lib etc var
#+BEGIN_SRC shell :results output
ls /
#+END_SRC

#+RESULTS:
#+begin_example
bin
boot
cdrom
dev
etc
home
lib
lib32
lib64
libx32
lost+found
media
mnt
proc
root
run
sbin
snap
srv
sys
tmp
usr
var
#+end_example

【分区和目录的联系】

那么说了这么半天，又是分区，又是目录的，分区跟目录有什么关系呢？有人说了：“我知道，分区就是C盘，D盘，E盘这些，每个盘里再有各自的目录。”兄弟，我只能告诉你，你又OUT了。刚才我说了我们Linux的目录结构，就是一个“/”目录，下面有一些次级目录，每个次级目录下面再有子目录及子子目录......无论分区情况如何，这个目录结构是不会变的。那么分区怎么跟目录联系起来呢？联系就是，你可以指定任意一个目录里的东西存在某个分区里，如果不指定，则这个目录里的东西存在上一级目录所在分区中，如果上一级目录也没有特殊指定分区，则再上溯一级目录，依此类推。这么一直上溯，就一定会上溯到最上层的根目录“/”。所以，装系统的时候，其他的可以不指定，但一定要指定“/”目录存放在哪个分区。
#+BEGIN_SRC shell :results output
ls /lib
#+END_SRC

#+RESULTS:
#+begin_example
accountsservice
apparmor
apt
aspell
at-spi2-core
avahi
bfd-plugins
binfmt.d
binfmt-support
bluetooth
bolt
calibre
cantata
cnf-update-db
colord
command-not-found
compat-ld
console-setup
cpp
crda
cryptsetup
cups
dbus-1.0
dconf
debug
dkms
dpkg
eject
emacs
emacsen-common
encfs
environment.d
file
firefox
firefox-addons
firmware
fwupd
gcc
geoclue-2.0
ghostscript
girepository-1.0
git-core
gnupg
gnupg2
GNUstep
gold-ld
groff
grub
grub-legacy
hdparm
init
initramfs-tools
ispell
kauth
kernel
klibc
klibc-KzNL5rI0ooqhK-koTVzHy10DW4w.so
language-selector
lantern
libadplug-2.2.1.so.0
libadplug-2.2.1.so.0.0.0
libchm.so.1
libchm.so.1.0.0
libepub.so.0
libepub.so.0.2.1
libfreecell-solver.so.0
libfreecell-solver.so.0.6.0
libgnustep-base.so.1.26
libgnustep-base.so.1.26.0
libhardsid-builder.so.0
libhardsid-builder.so.0.0.1
libkolabxml.so.1
libkolabxml.so.1.1.6
libmbim
libnetpbm.so.10
libnetpbm.so.10.0
libpodofo.so.0.9.6
libqmi
libreoffice
libresid-builder.so.0
libresid-builder.so.0.0.1
libsidplay2.so.1
libsidplay2.so.1.0.1
linux
linux-boot-probes
linux-sound-base
locale
lp_solve
lsb
man-db
mecab
memtest86+
mime
modprobe.d
modules
modules-load.d
mozilla
mysql
netplan
networkd-dispatcher
NetworkManager
nodejs
nvidia
openssh
os-prober
os-probes
os-release
p7zip
packagekit
pcmciautils
phantomjs
pkgconfig
pkg-config.multiarch
pm-utils
policykit-1
pppd
pulse-13.0
python2.7
python3
python3.7
python3.8
qt5
recovery-mode
rsyslog
ruby
sasl2
sbcl
sftp-server
shim
simplescreenrecorder
snapd
software-properties
ssl
sudo
sysctl.d
syslinux
SYSLINUX
syslinux-legacy
systemd
sysusers.d
tc
terminfo
tmpfiles.d
ubiquity
ubuntu-advantage
ubuntu-release-upgrader
udev
udisks2
ufw
upower
valgrind
X11
x86_64-linux-gnu
xorg
xserver-xorg-video-intel
#+end_example

比如说，可以整个硬盘就一个分区，然后指定根目录“/”存在这个分区中。好，那么整个“/”目录，以及“/”目录下的各级子目录里面的所有东西，都存放在这个大分区里。我也可以分两个区，分区甲和分区乙。我指定“/”目录存在分区甲里面，然后指定“/home”目录存在分区乙里面。那么整个“/”目录，以及“/”目录下的，除了“/home”目录及其下各级子目录外，其他目录里面的所有东西，都存在分区甲。“/home”目录及其下各级子目录里的东西，存在分区乙。当然，也可以分80多个分区，给每一个目录都手动指定一个分区来存放东西------如果你吃得有点多的话。

这种分区和目录的关系，就像你房子里的房间和功能区之间的关系一样。可以为做饭的地方单独分出一间屋子来，叫做厨房。但是也可以是开放式厨房，厨房并不单独放在一间屋子中，而是和饭厅公用一间屋子。同理，可以为“/home”单独指定一个分区，但也可以不单独指定，而是存在“/”所在的分区中，作为“/”下的一级子目录，和“/”公用一个分区空间。是不是很像呢？

最后再说一点，给某一个目录指定分区的动作，有个专业术语，叫做“挂载”，以后还会经常提到。
# 分区是物理动作，比如插入硬盘。

** 2.4　G大叔--介绍启动管理器Grub

经过漫长的等待之后，安装终于完成了。我总算离开了光盘，在硬盘里落户了。用户随即发出命令：重启！我满怀信心地看着已经来到硬盘上的兄弟们：“我们就要开始一段新的生活了，希望大家能够做出最大的努力，让用户认可我们这个系统。”看着兄弟们意味深长地对我点了点头之后，我静静地，闭上了眼睛，安心地睡去了，等待着G大叔把我叫醒。

*** 2.4.1　计算机启动流程

“嘿，小子，起床了！”

我睁开眼，看看眼前站的人，是门房的G大叔。我仔细回忆了一下......哦，想起来了。我刚刚被安装到一台电脑里，这是我的第一次启动。

有人说，你记性怎么这么差啊，这才几秒钟前发生的事情，你怎么就忘了？别奇怪，这是我们软件族的特点。一方面，几秒钟对我们软件来说已经是很长的时间了。另一方面，我们软件不像你们人类，睡觉的时候还能做个梦啥的。我们睡觉的时候（也就是系统没启动的时候），是什么也不知道的，之前发生的事情，需要记忆的，我们都会在睡觉前写成文件放在我们住的硬盘里，这样下次起床就能回忆起来了。

【起床的过程】

每当用户需要我起床工作的时候，他就会按下计算机的电源键，然后，就开始了我漫长的起床过程。

首先，当计算机的电源键被按下时，会有一股温暖而舒适的电流从电源涌入，流遍整个主板，流经每个元件，流到BIOS居住的那颗芯片里。BIOS就是开机时你按Del键进去的那个蓝屏幕（不是所有主板都按Del键进BIOS）。BIOS这个家伙其实也是一个软件，但他是一个特殊的软件，特殊到一般都不归在软件的行列里，而是被叫做“固件”，因为他住在主板上的一个芯片里，而不像我们住在硬盘里。电流流到BIOS住的芯片后，会由芯片上的某一根管脚流进芯片内部，并准确无误地击中的BIOS的身体，于是------BIOS就醒了（合着天天被电醒的，真惨）。
# 主板芯片.

[[./Images/image00227.jpeg]]*提示：*BIOS是Basic Input-Output System（基本输入/输出系统）的简写。

BIOS醒来之后就开始工作。他的工作平凡而重要，复杂而机械，就是去检查CPU、内存、显卡等是否都正常。都检查一遍没有问题之后，就来到我们住的硬盘这里，来到那间传达室，完成他的最后一个任务------叫醒在门房值班的那个人。
# 门房的比喻太棒了.
我搬到这里之后，门房里值班的人，就是G大叔了。G大叔大名叫做Grub{grand unified bootloader}，现在已经是2.0版本了。他是一个启动管理器，平时就住在传达室。所谓传达室，学名叫做MBR{Master Boot Record}，是一个硬盘的入口，硬盘的第0号扇区。传达室不属于任何一个房间，或者说，MBR不属于任何一个分区。
# 妙妙, 传达室的概念妙.
传达室很小，只有512Byte。由于传达室地方实在太小，因此G大叔会把一些有用的文件放在我的硬盘空间里，必要的时候来看看。

[[./Images/image00227.jpeg]]*提示：*MBR中的内容主要有两部分，一部分是启动代码，另一部分是硬盘的分区表。由于空间有限，只能写下4个分区的信息，因此一块硬盘最多只能有4个主分区或扩展分区。

G大叔被BIOS叫起来之后，会来我的硬盘里读取/boot/grub/grub.cfg文件，根据这个文件的内容来决定他的动作。这个文件里写了启动的时候应该给用户多少个选项，每个选项都是什么，背景啥样，等待多长时间等。G大叔按照这个文件上的要求显示给用户一个多系统选择的界面，就像图2.21这样（Grub默认界面应为黑底白字，本书为了提高印刷后的图片质量，特做反色处理）。

[[./Images/image00260.jpeg]]
图2.21　Grub启动界面

用户做出选择后，如果是选择了我，那么G大叔就像刚刚这样，来到我屋里，叫我起床，于是我这个Ubuntu系统就启动了。

*** 2.4.2　多系统的共存

可能有同学会问，那G大叔除了叫你之外，还能去叫谁呢？G大叔是个启动管理器，如果只负责引导我一个系统，那还怎么称得上“管理”二字呢？G大叔能够支持多种系统的引导。比如那个水果公司的MacOS系统、与我们Linux同宗的BSD系统、微软公司的“查皮”WindowsXP系统、“喂死它”Vista系统、“温妻”Windows7系统，甚至“剁死”（DOS）系统等，G大叔都能够支持。

具体怎样才能让G大叔引导其他系统呢？这个不用您操心，我们Ubuntu系统在安装的时候，会派G大叔去检查硬盘上已经存在的系统，然后根据情况制定出合理的计划。这一切都是G大叔自动完成的，您装完系统重启计算机后，就能看到硬盘上已有的系统已经被G大叔正确识别出来了。
# 原来是自动完成的, 所以需要最后安装linux系统.
[[./Images/image00227.jpeg]]*提示：*MaxOS需要安装在主分区才能够正确地被Grub引导。

就拿我定居的这台电脑做例子吧。

我们来之前，电脑里已经住进了一个操作系统，就是微软公司的Windows7。Windows7一个人住的时候，传达室是没人的，只放了一个简单的类似门铃的装置。BIOS来传达室叫人的时候，只要按一下那个铃，那边的启动管理器就会去叫Windows7起床了。

G大叔搬进去的时候，会考虑到原有的Windows7系统，查看一下叫醒Windows7的那个门铃连到了哪里。一般是连到一个叫做Bootmgr.exe的程序，一按门铃，Bootmgr.exe就被叫醒了。于是G大叔记好Bootmgr的位置，再记录好我的位置，生成一个grub.cfg文件，放到/boot/grub/目录下。咱不是说过么，我们软件要想记住点什么东西，都得写成文件放到硬盘里，G大叔也不例外。

当用户启动电脑，G大叔被叫醒的时候，他就会一脸严肃地问用户：要用哪个系统？一个Ubuntu一个Windows7，给你10秒，快选！如果用户选我，G大叔就来叫醒我，如果选Windows7，G大叔就去按照之前记录的位置，找到Bootmge，一脚把他踹醒。

虽然G大叔说话有点不客气，不过工作还是尽职尽责的，多数常见的操作系统、常用的分区格式，G大叔都不在话下。他总说，传达室不是某一个系统专用的传达室，在传达室工作的软件，就该为硬盘上的每一个系统都服务好。

[[./Images/image00227.jpeg]]*提示：*WindowsXP之前的NT内核系统使用的是ntldr作为启动管理器，从Vista开始换成了Bootmgr。新版的Grub对这两者都可以完美支持。

*** 2.4.3　重装Windows后Grub的修复

可是Windows 7那边的作风就不一样了。

如果硬盘上已经住进了我，门房里已经有了G大叔，这时候重装或者新装Windows7系统的话，Windows7就不管三七二十一地把G大叔赶出来，在传达室装好他的“起床铃”就走了，不管我这边的情况。电脑再启动的时候，BIOS就找不到G大叔，只能去按那个铃，直接启动Windows7，我的存在就完全被无视了。

如果这样的惨剧不幸发生了怎么办呢？没关系，他能把G大叔赶出来，我照样能让G大叔再搬进去！想强拆？没门！不过具体怎么操作呢？再重装一遍Ubuntu系统？不用。还记得那张安装光盘么？还记得我说系统出问题的时候可以用它来修复么？没错，就是那张，赶紧让你家狗狗把他叼回来，现在用上了！

像安装的时候一样，用LiveCD启动电脑，选择试用，这样就启动了光盘上的Ubuntu系统。这时候，电脑可就归我们Linux管啦！嘿嘿，小小的Windows
7算什么，你想把我们的G大叔撵走就霸占整个硬盘了？想得美！LiveCD启动之后，打开命令行，运行 =sudo-i= ，获取权限。然后运行：
: mount /dev/sdax /media/

提示：*$符号是普通用户的命令提示符，不是命令的一部分，不需输入。

这里sdax就是你安装Ubuntu的时候用作根目录“/”的那个分区，如果你还单独分了“/boot”分区，那么还得运行：
: mount /dev/sday /media/boot/

当然，这里的sdax，sday都需要根据你的实际分区情况修改，可能是sda1，sda4，或者sdb2，sdc8，都没准儿。mount好了之后，运行：
: grub-install -root-directory=/media/ /dev/sda

运行完了就好了。最后重启电脑，熟悉的G大叔又回来了。

当然，以上说的都是以后可能发生的情况，目前在我这里还没有这样的事情，隔壁那个Windows7睡得像死猪一样，不会有什么举动的。而G大叔早在安装的时候就自动设置好了多重系统启动，刚刚就是用户告诉G大叔来叫醒我去干活的。

*** 2.4.4　Grub的简单配置

起床之后，用户似乎对G大叔的举动不是很满意，打算要修改一下G大叔的配置文件。

刚才我们说了，G大叔启动的时候会去找=/boot/grub/grub.cfg=文件，这里面记录了G大叔应该做的一些事情。不过用户要想修改这些设置，可不需要修改这个文件，而是要改=/etc/default/grub=文件。这个文件里，简单明了地记录了G大叔应该做的一些动作。

[[./Images/image00227.jpeg]]*提示：*旧版Grub的配置文件为/boot/grub/menu.lst，新版Grub将原有的一个配置文件分为/boot/grub/grub.cfg和/etc/default/grub两个。前者更加复杂，提供给Grub读取，以提供更复杂的功能。后者更加简明，提供给用户，用于一些简单的配置。
# 找打了该命令.
只见用户下达了命令：
: sudo emacs /etc/default/grub

这么命令的意思就是，以root用户的身份，命令gedit软件，去打开/etc/default/grub文件。输入这个命令之后，我会要求用户再输入一遍他自己的密码，注意，是当前用户的密码（比如我这里，就是lanwoniu这个用户），不是root的密码，真正的root用户的密码......是个迷。关于这个sudo，咱们后面还会见到它，这里暂且不表，您只需要知道命令就这么敲就行了。命令运行后，就会看到打开了一个gedit软件，里面显示的就是grub文件的内容，大约就是这样：

[[./Images/image00265.jpeg]]

这一大堆看着有点乱，不过别害怕。首先，所有以#开头的行都是注释，那是给人类看的，G大叔会直接忽略掉这些行。剩下的就不多了，好，慢慢介绍。

[[./Images/image00227.jpeg]]*提示：*Linux下的绝大多数配置文件和脚本都以#作为注释行的开头。

[[./Images/image00218.jpeg]]　解释1：GRUB_DEFAULT=0这一行的意思，就是让G大叔在用户没有选择的情况下，默认来叫醒我。因为在电脑启动的时候，G大叔给用户的选项里，叫醒我是排在第1个的（但是G大叔数数喜欢从0开始数，所以是“=0”）。这里也可以写saved，意思就是记住上一次开机的选择。上次选的谁，这次就默认选谁。

[[./Images/image00218.jpeg]]　解释2：GRUB_HIDDEN_TIMEOUT_QUIET=true是说倒计时的过程中不显示秒数，只默默地计时。如果这一行设为false，则G大叔会显示倒计时还剩下多少秒。

[[./Images/image00218.jpeg]]　解释3：GRUB_TIMEOUT=10这一行是G大叔给用户选择的时间，也就是10秒钟。如果不选就根据GRUB_DEFAULT的设置，选择默认的系统去了。如果不希望有时间限制，就设置为--1。

[[./Images/image00218.jpeg]]　解释4：GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"这一行是启动时Grub大叔要传给我这个Linux内核的启动参数。这个参数只有在正常启动的时候会传给我，recover模式就不传了。quiet的意思是告诉我，启动时不要打印任何信息。splash是告诉我要显示启动画面。
# 显示启动画面.
[[./Images/image00218.jpeg]]　解释5：GRUB_CMDLINE_LINUX=""也是启动参数，跟上面那一行不一样的是，这一行设置的参数无论是什么启动模式，都会传给我。

我这个用户主要是想改改默认启动的系统，于是把GRUB_DEFAULT改成了4。我掐指一算，改成4，也就是启动时G大叔给用户的第5个选项......哦，是去叫醒Windows7。哎......看来还是不喜欢我啊。另外GRUB_TIMEOU也被用户改成了5，看来这个用户还是个急性子。

改完了之后，保存好这个文件，但还不算完，光改这个文件是不管用的，G大叔真正关心的是/boot/grub/grub.cfg文件。还得运行一下：
: sudo update-grub

这样，就会根据刚才修改的grub文件，自动生成一个给G大叔看新的grub.cfg文件，这就算修改完了。

*提示：*在Linux系统的终端中输入密码时，密码不会回显。
# 门房grub大叔, MBR是传达室, 硬盘的第一个扇区. bios首先被电醒.

** 2.5　更多选择

从安装到第一次启动，我还算比较顺利。可能是我遇到的这个用户运气好，也可能是我运气好，遇到个水平比较高的用户，到底是谁运气好，这是个哲学问题......不过总之，会有一些人安装Ubuntu不是那么顺利，或者因为种种原因安装遇到阻碍。不过没关系，没有什么困难是不能克服的，我们Ubuntu系统的安装方法多着呢。

*** 2.5.1　基于Windows的wubi安装

有人说，我就遇到困难了。你刚才讲了这么半天，那么多步骤，还得分区，还得设什么BIOS，太复杂了，听不懂啊。有简单点的办法没有？我告诉你，有。

为了使更多已经装了Windows7之类系统的人能够更加简单地安装和体验我们Ubuntu系统，我们的光盘里带了一个软件，叫做wubi。您可别误会，他可不是个输入法，不要妄想用五笔字型输入“我要装系统！”就能把Ubuntu装上。这个wubi是WindowsUBuntuInstaller的缩写。这家伙是运行在Windows7系统下的软件，他的功能，就是帮助你在Windows7系统下安装我们Ubuntu系统。不用你懂分区，不用你知道挂载，不用改变当前硬盘的状态，一切全都交给他就好。并且我们这个光盘还设置好了自动运行，光盘放进去就会看到wubi运行的界面了，就是图2.22所示的这样。

[[./Images/image00267.jpeg]]
图2.22　wubi运行界面

第1个选项，就是之前说的光盘安装。选了这个选项之后电脑就会重启，然后从光盘启动（当然还得设好BIOS），之后就跟我们说的光盘安装没有区别了，不选这个（不选你说那么半天！）。看第2个选项，“在Windows中安装”，这个看着新鲜吧？好，就是它了！
单击“在Windows中安装”按钮之后，就看到一个如图2.23所示的设置窗口。

[[./Images/image00268.jpeg]]
图2.23　wubi安装设置窗口

要设置的东西不多，也都挺简单的，咱们一个一个说。

（1）目标驱动器，就是让你选择把Ubuntu装在哪个盘上。一定要找个空闲空间大的盘，因为装的时候要在那个盘上创建一个巨大的文件，文件的大小就是下面那个“安装大小”里选的大小。这个巨大的文件会被Ubuntu当作硬盘来用，系统就装在这里面，因此就不需要调整你的实体硬盘了，避免出现数据丢失。怎么样，很人性吧？

[[./Images/image00227.jpeg]]*提示：*由于FAT32支持的文件大小有限，因此选择的目标驱动器需要使用NTFS文件系统。

（2）安装大小，不多说了，就是用来当硬盘的那个文件的大小。这个大小一旦确定，装好Ubuntu系统之后，可就不能改了，所以一定要想好。如果想日常使用，至少要20GB，如果只是装来看看，10GB就够了。

（3）桌面环境，没啥可选的，就是Ubuntu。

（4）语言，你说呢？

（5）用户名，就是安装时创建的那个有变身能力的用户。

（6）口令，就是密码，你知道的，国际惯例。

都选好了，自然就单击下面的“安装”按钮。之后就进入安装的第一阶段，这里没什么可说的，都是毫无悬念的进度条。这个过程结束之后会问你要不要重启。如果你正跟小妹妹聊得火热，待会儿再重启也不妨，如果没什么事情，那就赶快重启看看吧。

重启之后会看到系统选择的界面，装过多个Windows的同学会很熟悉，就像图2.24所示的这样（此界面应为黑底白字，本书为了提高印刷后的图片质量，特做反色处理）。

[[./Images/image00269.jpeg]]

图2.24　wubi安装后的多系统选择界面

选哪个？还用问吗，自然是Ubuntu。选择之后就进入安装的第2个阶段，第2阶段也只是没有悬念的进度条而已，等着就好了。装好了再重启，OK，可以进入Ubuntu了。

[[./Images/image00227.jpeg]]*提示：*wubi安装的Ubuntu系统由于使用的是虚拟的硬盘，因此磁盘读写的性能要比装在真实硬盘上的Ubuntu差一些，并且可能会导致系统不稳定。

*** 2.5.2　U盘安装

又有人说了，我还有困难。你上面说的方法都得用光盘吧，可我的电脑没有光驱，这可就没法装了吧。不管是申请来的光盘还是自己把ISO刻录成光盘都得有光驱呀。别急，光盘没有，U盘有没有？有U盘就行！

要想用U盘安装，需要几个前提。

（1）你得有个U盘（废话！），注意一定得是U盘，别拿个MP3或者手机糊弄我，弄坏了我可不负责。

（2）你的电脑要支持U盘启动，支持不支持查你的主板说明书去。基本上只要你的主板不是那种.能在古董市场看到的型号，都应该支持。

（3）就是我们接下来要介绍的，需要一个制作安装U盘的软件。

【用UltraISO制作安装U盘】

话说有这么个软件，叫做UltraISO。这家伙本事挺大，可以用来刻录光盘。“我没光驱啊，刻录的哪门子光盘啊！”您别着急，我还没说完呢，他不但可以刻录光盘，还能刻录U盘。

把您的U盘准备好，里面的内容赶紧先找别的地方存起来，一会儿就啥都没了。把U盘插在电脑上，运行UltraISO软件，会看到如图2.25所示的界面。单击左上角的“文件”菜单，选择打开，然后找到你下载的Ubuntu系统的ISO文件。打开ISO文件后的界面如图2.26所示。

[[./Images/image00270.jpeg]]

图2.25　UltraISO软件主界面

[[./Images/image00271.jpeg]]

图2.26　打开Ubuntu的ISO文件

[[./Images/image00227.jpeg]]*提示：*由于Windows7系统提高了系统的安全性，因此在Windows7中运行UltraISO软件需要以管理员身份运行。
然后单击“启动光盘”|“写入硬盘映像”菜单，会弹出“写入硬盘映像”窗口，如图2.27所示。

[[./Images/image00272.jpeg]]
图2.27 “写入硬盘映像”窗口

在该窗口中的“硬盘驱动器”下拉列表框里选择好你的U盘，可一定要选对哦，否则就指不定丢多少数据了。“写入方式”选择USB-HDD+，然后就开始吧，单击“写入”按钮。等写入完了，你的启动U盘就制作好了，用它启动电脑就像用LiveCD启动电脑一样了。不过要说明的一点，这个UltraISO可是要付费的，别偷来就用哦。“我平时也不用，就为了刻录一下还得付费？有点亏啊。”嗯，可能是有点，如果您不想用付费软件，没关系，咱还有办法。

[[./Images/image00227.jpeg]]*提示：*此方法仅限于Ubuntu10.04及其以前的系统。Ubuntu10.10及其以后的系统，由于ISO文件发生变化，无法使用UltraISO软件制作安装U盘，只可以使用下面介绍的UNetbootin软件制作安装U盘。

【用UNetbootin制作安装U盘】

还有个软件，叫UNetbootin。这个家伙是个免费的开源软件，可以到这个地方来找他：

这个软件同时支持Windows 7系统和我们Linux系统，您既然是想在Windows
7下创建Ubuntu的LiveUSB，那么自然要下载那个“ForWindows”版本的。从网上把这个软件下载到你的机器上，不需安装，直接运行。运行之后，就出现图2.28所示的界面。

[[./Images/image00274.jpeg]]

图2.28　UNetbootin软件界面

首先，整个界面上有两个单选按钮：一个是“发行版”；一个是“光盘镜像”。

如果选中上面的“发行版”单选按钮，那么软件就会从网络上下载指定的发行版并刻录到你的U盘，这属于一站式烧录，不过多数人不这么用。

你已经下载了Ubuntu的ISO文件，所以应该选中“光盘镜像”单选按钮，然后单击后面的“...”按钮（也不给按钮起个好名字），选择存在硬盘上的ISO文件。在“类型”下拉列表框里选择“USB驱动器”，再在“驱动器”下拉列表框中找到对应你U盘的驱动器（注意，驱动器一定要选择对！否则的话指不定你哪个硬盘的数据就挂了！）。至于“Space
used to......”那一行后面，如果你只是想安装系统，空着就可以了。

确认都选对了之后，单击“确定”按钮，就可以等着了。UNetbootin理论上是不会破坏你U盘上已有的数据的，但是你的U盘必须有足够的剩余空间，能放下一个ISO文件就差不多了。不过，虽然如此，还是建议你事先备份一下U盘的数据。

*** 2.5.3　其他版本的Ubuntu介绍

另外，去网上下载Ubuntu的同学也许会发现，除了ubuntu-10.04-desktop-i386.iso这个LiveCD以外，还有很多其他的Ubuntu安装光盘，比如什么ubuntu-10.04-desktop-amd64.iso、ubuntu-10.04-dvd-i386.iso、ubuntu-10.04-dvd-amd64.iso、ubuntu-10.04-alternate-i386.iso等。这么多种，有什么不一样呢？等我慢慢说给您听。

【i386和amd64的区别】

先说这个，ubuntu-10.04-desktop-amd64.iso。它和ubuntu-10.04-desktop-i386.iso唯一的区别就是一个是i386，一个是amd64（废话，傻子都知道！）。这里i386和amd64说的是CPU的类型。有的同学会说：“哦，那我知道了，这个i386，因为有i嘛，就是用在Intel公司的CPU上的，那个amd64自然就是用在AMD公司的CPU上的。”我很高兴地告诉这位同学：“你答错了！”i386指的是x86架构的32位CPU，因为这种架构是在当年Intel公司生产Intel
386处理器时就确定下来的，所以叫做i386。之后的奔腾几都是这个架构。还有AMD公司，也生产兼容x86架构的CPU，一大堆这个龙那个龙的，都是i386兼容的CPU。后来随着技术的发展，32位的CPU逐渐退出了历史舞台，出现了64位的CPU，至于具体什么是32位，什么是64位，它们有什么不同，咱们以后会详细说。

最先推出桌面用64位CPU的，就是AMD公司。所以目前普通PC用的64位CPU这种架构是AMD公司确定的，于是就叫做amd64。那什么CPU才是64位CPU呢？基本上你现在能买到的全是！刚才那位同学又说了：“哦，那我明白了。i386就只能装在32位的古董级CPU上，amd64就只能装在主流的64位CPU上。”我再次恭喜这位同学------又错了！考虑到现在的很多软件依然不支持64位，所以现在的家用64位CPU都是兼容32位的，也就是说在64位CPU上安装i386的系统是可以的，但是要在32位CPU上安装amd64的系统，那确实不行，想都甭想。

【DVD和CD的区别】

然后咱再说说这个ubuntu-10.04-dvd-i386.iso。最后的这个i386不用解释了，跟上面一样。主要就是这个“dvd”。其实这个安装文件跟desktop的区别就是，那个是CD的，这个是DVD的（又跟没说一样）。这个DVD的里面比那个CD多了一些常用的软件和语言包。不过有一点，默认安装的软件和CD版的是一样的，别以为DVD的就多给你装什么软件。只不过装完系统之后，可以从光盘安装其他的软件而不用上网去下载。这主要是针对上网不大方便的人用的。有一张DVD，基本软件就都齐了。另外还有一点好处就是，如果你选择的语言是汉语，DVD版的装好了之后有比较完整的汉化了，因为DVD容量大，可以装下更多的语言包。

【灵活的Alternate】

再说说这个ubuntu-10.04-alternate-i386.iso。Alternate的意思就是安装的时候可以选择安装的软件，可以装成桌面版，也可以装成服务器版，可以有图形界面，也可以没有图形界面。总之，有很多选择，是给高手们预备的。另外这个版本在安装的时候是没有图形界面的，安装时的界面大约类似图2.29这样。所以英语好、对Linux系统熟悉的同学才可以安装。

[[./Images/image00275.jpeg]]

图2.29　Alternate版本的安装界面

【高深的Server版】

最后，可能有的同学还找到了Server版本的Ubuntu系统。也许你是打算学习用Linux系统搭建各种网络服务器的知识，并且根据以前用Windows
2003之类的服务器系统的经验，觉得装个Server版就直接从入门到精通了。但是我们Ubuntu系统可不是这样，Server版绝对是专门当Server用的，因为------他们完全没有图形界面！

并且这里要说明的是，Server版和桌面版的区别并不大。一方面是自带的软件不一样，但是Server版也可以通过软件源装上桌面版的软件，反之亦然；另一方面，Server版用的是服务器专用的内核，但同样，桌面版也可以通过软件源，安装服务器版的内核，反之亦然。所以，无论你要用Ubuntu做什么，只要你是个新手，就推荐安装桌面版。

【各种其他“兔兔”】

除了我这种标准的“"乌棒兔"”------Ubuntu系统之外，我们Canonical学校其实还针对不同用户的需求，开设了很多其他的专业，培养出了多种“兔兔”。下面我就给您介绍一下其中最热门的3个吧：酷兔兔、小兔兔、育兔兔。

“酷兔兔”，也就是Kubuntu。他们都是艺术专业培养出来的学生。他们的样子要比我们Ubuntu好看些，精致些。这主要是因为负责为他们提供桌面环境的，是KDE团队，也因此才叫做Kubuntu。KDE桌面环境的特点，就是美观、细腻，并且愿意把各种部分的设置能力交给用户，让用户可以随心所欲地把自己的桌面改成想要的任何样子。图2.30所示就是Kubuntu系统的一个截图。

[[./Images/image00276.jpeg]]

图2.30　Kubuntu界面

“小兔兔”大名为Xubuntu。他们都是准备去艰苦环境下工作的志愿者。Xubuntu使用的桌面环境不是Gnome也不是KDE，而是XFCE，样子很朴素，就像图2.31所示的那样。XFCE的特点就是小巧，占用资源少。可以在很艰苦的硬件条件下很好地工作。比如内存，Xubuntu能够在200
MB内存的机器上流畅地运行。当然，相应的软件也要用一些轻量级的。要是在Xubuntu下运行一个非常耗资源的程序，那么该慢照样慢。

[[./Images/image00277.jpeg]]

图2.31　Xubuntu界面

Edubuntu，我们管他叫“育兔兔”，因为他是教育专业出身。Edubuntu用的桌面环境跟我一样，只是他附带了很多搞教育的软件，能够教小孩子打字、画画、学习物理知识之类的软件。图2.32中展示的，就是一些Edubuntu系统里的教育软件。这些软件都是很好的老师，很多小孩子用起来都乐此不疲。很多小游戏也都是寓教于乐的，家长给孩子用这个系统，完全不必担心孩子沉迷于游戏（因为实在没啥可沉迷的游戏......）。

[[./Images/image00278.jpeg]]

图2.32　Edubuntu中的教育软件

** 2.6　本章小结

这"乌棒兔"到现在，算是定居到了那位lanwoniu用户的PC上了。而且生活条件不错，硬盘宽敞，内存也够大，门房的那个Grub也幸运地没有遇到隔壁的强拆。折腾了这么半天，也够这兔子累的了。

不过光安装结束还远不算完，后面还有好多事等着他呢。诸位且听下回分解，看用户如何调教"乌棒兔"。
#+BEGIN_QUOTE
安装过程可以忽略,
启动过程bios的作用,Efi Extensible Fireware Interface
门房grub,达室MBR,
从有限的资源出发.
#+END_QUOTE
